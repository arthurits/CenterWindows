<Page
    x:Class="CenterWindow.Views.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:helpers="using:CenterWindow.Helpers"
    xmlns:xaml="using:Microsoft.UI.Xaml"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:ui="using:CommunityToolkit.WinUI"
    xmlns:conv="using:CenterWindow.Converters"
    xmlns:sys="using:System"
    xmlns:viewmodel="using:CenterWindow.ViewModels"
    d:DataContext="{d:DesignInstance Type=viewmodel:SettingsViewModel, IsDesignTimeCreatable=False}"
    mc:Ignorable="d"
    NavigationCacheMode="Enabled">

    <Page.Resources>
        <conv:BoolToIconElementConverter x:Key="BoolToIconElementConverter"/>
    </Page.Resources>
    
    <Grid x:Name="Settings" ColumnDefinitions="*" RowDefinitions ="*" x:DefaultBindMode="OneWay">
        <ScrollView x:Name="ScrollSettingsPage" ContentOrientation="Vertical"
                    HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch"
                    ZoomMode="Disabled" IsTabStop="True"
                    VerticalAlignment="Top" HorizontalAlignment="Stretch"
                    HorizontalScrollMode="Disabled" HorizontalScrollBarVisibility="Hidden"
                    VerticalScrollMode="Auto" VerticalScrollBarVisibility="Auto">

            <StackPanel Orientation="Vertical" Style="{StaticResource BaseStackPanel}" Spacing="6">
                
                <!--App settings-->
                <TextBlock Text="{Binding StrAppSettings}" Style="{StaticResource SubtitleTextBlockStyle}" Margin="0, 12, 0, 0"/>

                <controls:SettingsCard x:Name="cardTheme"
                               Description="{Binding StrThemeDescription}"
                               Header="{Binding StrThemeHeader}"
                               HeaderIcon="{ui:FontIcon Glyph=&#xE793;}">
                    <!--<controls:SettingsCard.HeaderIcon>
                        <FontIcon Glyph="&#xE790;" Foreground="Red">
                        </FontIcon>
                    </controls:SettingsCard.HeaderIcon>-->
                    <ComboBox
                        ItemsSource="{Binding ColorModes}"
                        SelectedIndex="{Binding Theme, Mode=TwoWay}"
                        SelectedValuePath="Value"
                        DisplayMemberPath="DisplayName">
                    </ComboBox>
                </controls:SettingsCard>

                <controls:SettingsCard x:Name="cardCulture"
                        Description="{Binding StrLanguageDescription}"
                        Header="{Binding StrLanguageHeader}"
                        HeaderIcon="{ui:FontIcon Glyph=&#xE774;}"
                        IsEnabled="True">
                    <ComboBox x:Name="LanguageComboBox"
                        ItemsSource="{Binding AvailableLanguages}"
                        SelectedIndex="{Binding SelectedLanguageIndex, Mode=TwoWay}"
                        SelectedValuePath="LanguageTag"
                        DisplayMemberPath="DisplayName">
                    </ComboBox>
                </controls:SettingsCard>
                
                <controls:SettingsCard x:Name="cardWinPos"
                       Header="{Binding StrWindowPositionHeader}"
                       HeaderIcon="{ui:FontIcon Glyph=&#xE840;}">
                    <controls:SettingsCard.Description>
                        <StackPanel Orientation="Vertical">
                            <TextBlock Text="{Binding StrWindowPositionDescription}"/>
                            <TextBlock Text="{Binding WindowSizeDescription}"/>
                            <TextBlock Text="{Binding WindowPositionDescription}"/>
                            <!--<TextBlock Text="{x:Bind sys:String.Format(x:Null, SettingsViewModel.StrWindowSize, SettingsViewModel.AppSettings.WindowWidth, SettingsViewModel.AppSettings.WindowHeight), Mode=OneWay}"/>
                            <TextBlock Text="{x:Bind sys:String.Format(x:Null, SettingsViewModel.StrWindowPosition, SettingsViewModel.AppSettings.WindowLeft, SettingsViewModel.AppSettings.WindowTop), Mode=OneWay}"/>-->
                        </StackPanel>
                    </controls:SettingsCard.Description>
                    <ToggleSwitch IsOn="{Binding WindowPosition, Mode=TwoWay}" OnContent="{Binding StrActivate}" OffContent="{Binding StrDeactivate}"/>
                </controls:SettingsCard>

                <controls:SettingsCard x:Name="cardPath"
                        Description="{Binding StrFilepathDescription}"
                        Header="{Binding StrFilepathHeader}"
                        HeaderIcon="{ui:FontIcon Glyph=&#xE838;}"
                        IsEnabled="False">
                    <ToggleSwitch IsOn="{Binding RememberFileDialogPath, Mode=TwoWay}" OnContent="{Binding StrActivate}" OffContent="{Binding StrDeactivate}"/>
                </controls:SettingsCard>

                <controls:SettingsCard x:Name="showTrayIcon"
                        Description="{Binding StrShowTrayIconDescription}"
                        Header="{Binding StrShowTrayIconHeader}"
                        HeaderIcon="{ui:FontIcon Glyph=&#xE91C;}">
                    <ToggleSwitch IsOn="{Binding ShowTrayIcon, Mode=TwoWay}" OnContent="{Binding StrActivate}" OffContent="{Binding StrDeactivate}"/>
                </controls:SettingsCard>

                <controls:SettingsCard x:Name="minimizeToTray"
                        Description="{Binding StrMinimizeToTrayDescription}"
                        Header="{Binding StrMinimizeToTrayHeader}"
                        HeaderIcon="{ui:FontIcon Glyph=&#xE944;}"
                        IsEnabled="{Binding IsMinimizeToTrayEnabled}">
                    <ToggleSwitch IsOn="{Binding MinimizeToTray, Mode=TwoWay}" OnContent="{Binding StrActivate}" OffContent="{Binding StrDeactivate}"/>
                </controls:SettingsCard>

                <controls:SettingsCard x:Name="launchAtStartup"
                        Description="{x:Bind ViewModel.StrLaunchAtStartupDescription}"
                        Header="{x:Bind ViewModel.StrLaunchAtStartupHeader}"
                        HeaderIcon="{ui:FontIcon Glyph=&#xE8FC;}"
                        IsEnabled="{x:Bind ViewModel.IsLaunchAtStartupEnabled}">
                    <ToggleSwitch IsOn="{x:Bind ViewModel.LaunchAtStartup, Mode=TwoWay}" OnContent="{x:Bind ViewModel.StrActivate}" OffContent="{x:Bind ViewModel.StrDeactivate}"/>
                </controls:SettingsCard>

                <!-- Window selection -->
                <TextBlock Text="{Binding StrWindowSelection}" Style="{StaticResource SubtitleTextBlockStyle}" Margin="0, 12, 0, 0"/>
                
                <controls:SettingsExpander
                    x:Name="cardHighlighter"
                    HeaderIcon="{ui:FontIcon Glyph=&#xE7E6;}"
                    Header="{x:Bind ViewModel.StrShowHighlightHeader}"
                    Description="{x:Bind ViewModel.StrShowHighlightDescription}">
                    <ToggleSwitch IsOn="{x:Bind ViewModel.ShowHighlight, Mode=TwoWay}" OnContent="{x:Bind ViewModel.StrActivate}" OffContent="{x:Bind ViewModel.StrDeactivate}"/>
                    <controls:SettingsExpander.Items>
                        <controls:SettingsCard x:Name="cardBorderColor"
                            Header="{x:Bind ViewModel.StrBorderColorHeader}"
                            HeaderIcon="{ui:FontIcon Glyph=&#xE790;}"
                            Description="{x:Bind ViewModel.StrBorderColorDescription}"
                            IsEnabled="{x:Bind ViewModel.ShowHighlight, Mode=OneWay}">
                            <muxc:ColorPicker
                                ColorSpectrumShape="Box"
                                IsMoreButtonVisible="False"
                                IsColorSliderVisible="True"
                                IsColorChannelTextInputVisible="True"
                                IsHexInputVisible="True"
                                IsAlphaEnabled="False"
                                IsAlphaSliderVisible="True"
                                IsAlphaTextInputVisible="True"
                                Color="{x:Bind ViewModel.BorderColorUI, Mode=TwoWay}" />
                        </controls:SettingsCard>
                        <controls:SettingsCard x:Name="cardBorderThickness"
                            Header="{x:Bind ViewModel.StrBorderThicknessHeader}"
                            HeaderIcon="{ui:FontIcon Glyph=&#xEDA8;}"
                            Description="{x:Bind ViewModel.StrBorderThicknessDescription}"
                            IsEnabled="{x:Bind ViewModel.ShowHighlight, Mode=OneWay}">
                            <Slider Minimum="0" Maximum="10" Value="{x:Bind ViewModel.BorderThickness, Mode=TwoWay}" />
                        </controls:SettingsCard>
                        <controls:SettingsCard x:Name="cardBorderRadius"
                            Header="{x:Bind ViewModel.StrBorderRadiusHeader}"
                            HeaderIcon="{ui:FontIcon Glyph=&#xEF20;}"
                            Description="{x:Bind ViewModel.StrBorderRadiusDescription}"
                            IsEnabled="{x:Bind ViewModel.ShowHighlight, Mode=OneWay}">
                            <Slider Minimum="0" Maximum="10" Value="{x:Bind ViewModel.BorderRadius, Mode=TwoWay}" />
                        </controls:SettingsCard>
                    </controls:SettingsExpander.Items>
                </controls:SettingsExpander>

                <controls:SettingsCard
                    x:Name = "cardShowChild"
                    Header="{x:Bind ViewModel.StrSelectChildHeader}"
                    HeaderIcon="{ui:FontIcon Glyph=&#xE7C4;}"
                    Description="{x:Bind ViewModel.StrSelectChildDescription}" >
                    <ToggleSwitch IsOn="{x:Bind ViewModel.SelectChildWindows, Mode=TwoWay}" OnContent="{Binding StrActivate}" OffContent="{Binding StrDeactivate}" />
                </controls:SettingsCard>

                <controls:SettingsCard
                    x:Name = "cardChangeCursor"
                    Header="{x:Bind ViewModel.StrChangeCursorHeader}"
                    HeaderIcon="{x:Bind ViewModel.ChangeCursor, Converter={StaticResource BoolToIconElementConverter}}"
                    Description="{x:Bind ViewModel.StrChangeCursorDescription}" >
                    <ToggleSwitch IsOn="{x:Bind ViewModel.ChangeCursor, Mode=TwoWay}" OnContent="{Binding StrActivate}" OffContent="{Binding StrDeactivate}" />
                </controls:SettingsCard>

                <controls:SettingsCard
                    x:Name = "cardRestoreCursor"
                    Header="{x:Bind ViewModel.StrRestoreCursorHeader}"
                    HeaderIcon="{ui:FontIcon Glyph=&#xE7A7;}"
                    Description="{x:Bind ViewModel.StrRestoreCursorDescription}" >
                    <ToggleSwitch IsOn="{x:Bind ViewModel.RestoreCursor, Mode=TwoWay}" OnContent="{Binding StrActivate}" OffContent="{Binding StrDeactivate}" />
                </controls:SettingsCard>

                <controls:SettingsCard
                    x:Name = "cardRememberRestoreCursor"
                    Header="{x:Bind ViewModel.StrRememberRestoreCursorHeader}"
                    HeaderIcon="{ui:FontIcon Glyph=&#xE840;}"
                    Description="{x:Bind ViewModel.StrRememberRestoreCursorDescription}"
                    IsEnabled="{x:Bind ViewModel.IsRememberRestoreCursorEnabled}">
                    <ToggleSwitch IsOn="{x:Bind ViewModel.RememberRestoreCursor, Mode=TwoWay}" OnContent="{Binding StrActivate}" OffContent="{Binding StrDeactivate}" />
                </controls:SettingsCard>
                
                <!--Reset settings button-->
                <Button x:Name="BtnReset"
                        Margin="{StaticResource SmallTopMargin}"
                        VerticalAlignment="Bottom"
                        HorizontalAlignment="Center"
                        Command="{Binding ResetSettingsCommand}"
                        IsEnabled="{Binding IsResetVisible}">
                    <StackPanel Padding="{StaticResource XXSmallLeftTopRightBottomMargin}" Orientation="Horizontal">
                        <FontIcon Glyph="&#xe8ee;" Margin="{StaticResource XSmallRightMargin}" />
                        <TextBlock Text="{Binding StrResetButton}"/>
                    </StackPanel>
                </Button>
                
            </StackPanel>
        </ScrollView>
    </Grid>
</Page>
